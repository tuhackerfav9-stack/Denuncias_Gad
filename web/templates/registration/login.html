{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Ingreso al Sistema | GAD Salcedo</title>
<link rel="icon" sizes="32x32" href="{% static 'assets/img/favicon-32.png' %}">
<link rel="icon" sizes="16x16" href="{% static 'assets/img/favicon-16.png' %}">

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap -->
  <link href="{% static 'assets/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- iziToast -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/css/iziToast.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <style>
    body{
      font-family: 'Poppins', sans-serif;
      min-height: 100vh;
      background:
        linear-gradient(rgba(116,116,116,.92), rgba(116,116,116,.92)),
        url("{% static 'assets/img/fondo_web.png' %}") center/cover no-repeat;
    }

    .login-card{
      backdrop-filter: blur(12px);
      background: rgba(255,255,255,.97);
      border-radius: 18px;
      box-shadow: 0 25px 60px rgba(0,0,0,.25);
      padding: 34px;
    }

    .login-title{
      color:#0d6efd;
      font-weight: 700;
      letter-spacing: .2px;
    }

    /* ===== Floating Field ===== */

.floating-group{
  position: relative;
  display: flex;
  align-items: center;
}

.floating-group input{
  width: 100%;
  height: 58px;
  border-radius: 16px;
  border: 1px solid #E5E7EB;
  padding: 22px 70px 8px 18px;
  font-size: 15px;
  background: #fff;
  transition: all .2s ease;
}

.floating-group input:focus{
  border-color:#93C5FD;
  box-shadow: 0 0 0 .25rem rgba(13,110,253,.15);
  outline: none;
}

.floating-group label{
  position:absolute;
  left:18px;
  top:18px;
  font-size:14px;
  color:#6B7280;
  pointer-events:none;
  transition: all .18s ease;
  background:#fff;
  padding:0 6px;
}

.floating-group input:focus + label,
.floating-group input:not(:placeholder-shown) + label{
  top:-9px;
  font-size:12px;
  color:#0d6efd;
}

.field-icon{
  position:absolute;
  right:10px;
  width:44px;
  height:44px;
  border-radius:12px;
  border:1px solid #E5E7EB;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#fff;
  color:#9CA3AF;
  transition:.2s ease;
}
.field-icon-btn{
  cursor: pointer;
}

.field-icon-btn:hover{
  border-color:#cbd5e1;
  color:#6b7280;
}

.field-icon-btn:active{
  transform: scale(.98);
}



    /* Input con icono a la derecha (NO dentro del campo) */
    /*.field-row{
    /*  display:flex;
    /*  align-items:center;
    /*  gap: 10px;
    /*}
/*
    /*.field-row .form-control{
    /*  flex: 1;
    /*  border-radius: 14px;
    /*  height: 52px;
    /*  padding: 12px 16px;
    /*  border: 1px solid #E5E7EB;
    /*  transition: .15s ease;
    /*}
/*
    /*.field-row .form-control:focus{
    /*  border-color:#93C5FD;
    /*  box-shadow: 0 0 0 .25rem rgba(13,110,253,.16);
    /*}
/*
    /*.field-icon{
    /*  width: 44px;
    /*  height: 44px;
    /*  border-radius: 12px;
    /*  border: 1px solid #E5E7EB;
    /*  background: #fff;
    /*  display:flex;
    /*  align-items:center;
    /*  justify-content:center;
    /*  color:#9CA3AF;
    /*  flex-shrink:0;
    /*}

    /* Estado inválido (rojo) */
    .is-invalid-soft{
      border-color: #dc3545 !important;
      box-shadow: 0 0 0 .25rem rgba(220,53,69,.10) !important;
      background: #fff7f7 !important;
    }
    .icon-invalid{
      border-color:#dc3545 !important;
      color:#dc3545 !important;
      background:#fff7f7 !important;
    }

    .btn-gad{
      background:#0d6efd;
      border:none;
      border-radius: 14px;
      padding: 12px 18px;
      font-weight: 700;
      color:#fff;
      height: 52px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
    }
    .btn-gad:hover{ background:#0b5ed7; }

    /* iziToast estilo “pro” */
    .iziToast{
      border-radius: 12px !important;
      box-shadow: 0 14px 30px rgba(0,0,0,.16) !important;
      padding: 14px 16px !important;
      overflow: hidden !important;
    }
    .iziToast > .iziToast-body .iziToast-texts{ margin-left: 44px !important; }
    .iziToast > .iziToast-body .iziToast-title{ font-weight:700 !important; font-size:14px !important; }
    .iziToast > .iziToast-body .iziToast-message{ font-size:14px !important; }
    .iziToast > .iziToast-progressbar{ height:3px !important; }

    @media (max-width: 420px){
      .login-card{ padding: 26px; }
    }
  </style>
</head>

<body class="d-flex align-items-center justify-content-center">

  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6 col-lg-5 col-xl-4">

        <div class="login-card">

          <div class="text-center mb-4">
            <h5 class="login-title d-flex align-items-center gap-2 mb-0">
              <svg width="22" height="22" viewBox="0 0 24 24" aria-hidden="true">

                <!-- Puntos sólidos -->
                <circle cx="6" cy="2" r="2.5" fill="#0d6efd"></circle>
                <circle cx="6" cy="11" r="2.5" fill="#0d6efd"></circle>
                <circle cx="14" cy="19" r="2.5" fill="#0d6efd"></circle>

                <!-- Punto protagonista (contorno) -->
                <circle cx="14" cy="11" r="2.5" fill="#ffffff" stroke="#0d6efd" stroke-width="1"></circle>

                </svg>
              Ingreso al Sistema
            </h5>
          </div>

          <form id="loginForm" method="post" novalidate>
            {% csrf_token %}

            <!-- Usuario 
            <div class="mb-3">
              <label class="form-label fw-semibold mb-2">Usuario <span class="text-danger">*</span></label>

              <div class="field-row">
                <input
                  type="text"
                  name="username"
                  id="id_username"
                  class="form-control"
                  placeholder="Ingrese su usuario"
                  autocomplete="username"
                >

                <div class="field-icon" id="iconUser" aria-hidden="true">
                  
                  <svg aria-hidden="true" fill="none" focusable="false" height="22" role="presentation" viewBox="0 0 24 24" width="22">
                    <path d="M17 3.5H7C4 3.5 2 5 2 8.5V15.5C2 19 4 20.5 7 20.5H17C20 20.5 22 19 22 15.5V8.5C22 5 20 3.5 17 3.5ZM17.47 9.59L14.34 12.09C13.68 12.62 12.84 12.88 12 12.88C11.16 12.88 10.31 12.62 9.66 12.09L6.53 9.59C6.21 9.33 6.16 8.85 6.41 8.53C6.67 8.21 7.14 8.15 7.46 8.41L10.59 10.91C11.35 11.52 12.64 11.52 13.4 10.91L16.53 8.41C16.85 8.15 17.33 8.2 17.58 8.53C17.84 8.85 17.79 9.33 17.47 9.59Z" fill="currentColor"></path>
                  </svg>
                </div>
              </div>
            </div>
            -->
            <div class="mb-4">
                <div class="floating-group">
                    <input
                    type="text"
                    name="username"
                    id="id_username"
                    placeholder=" "
                    autocomplete="username"
                    >
                    <label for="id_username">Usuario <span class="text-danger">*</span></label>

                    <div class="field-icon" id="iconUser">
                    <!-- SVG correo -->
                    <svg height="22" width="22" viewBox="0 0 24 24" fill="none">
                        <path d="M17 3.5H7C4 3.5 2 5 2 8.5V15.5C2 19 4 20.5 7 20.5H17C20 20.5 22 19 22 15.5V8.5C22 5 20 3.5 17 3.5ZM17.47 9.59L14.34 12.09C13.68 12.62 12.84 12.88 12 12.88C11.16 12.88 10.31 12.62 9.66 12.09L6.53 9.59C6.21 9.33 6.16 8.85 6.41 8.53C6.67 8.21 7.14 8.15 7.46 8.41L10.59 10.91C11.35 11.52 12.64 11.52 13.4 10.91L16.53 8.41C16.85 8.15 17.33 8.2 17.58 8.53C17.84 8.85 17.79 9.33 17.47 9.59Z" fill="currentColor"/>
                    </svg>
                    </div>
                </div>
            </div>

            <!-- Contraseña 
            <div class="mb-4">
              <label class="form-label fw-semibold mb-2">Contraseña <span class="text-danger">*</span></label>

              <div class="field-row">
                <input
                  type="password"
                  name="password"
                  id="id_password"
                  class="form-control"
                  placeholder="Ingrese su contraseña"
                  autocomplete="current-password"
                >

                <div class="field-icon" id="iconPass" aria-hidden="true">
                  
                  <svg aria-hidden="true" fill="none" focusable="false" height="22" role="presentation" viewBox="0 0 24 24" width="22">
                    <path d="M12.0011 17.3498C12.9013 17.3498 13.6311 16.6201 13.6311 15.7198C13.6311 14.8196 12.9013 14.0898 12.0011 14.0898C11.1009 14.0898 10.3711 14.8196 10.3711 15.7198C10.3711 16.6201 11.1009 17.3498 12.0011 17.3498Z" fill="currentColor"></path>
                    <path d="M18.28 9.53V8.28C18.28 5.58 17.63 2 12 2C6.37 2 5.72 5.58 5.72 8.28V9.53C2.92 9.88 2 11.3 2 14.79V16.65C2 20.75 3.25 22 7.35 22H16.65C20.75 22 22 20.75 22 16.65V14.79C22 11.3 21.08 9.88 18.28 9.53ZM12 18.74C10.33 18.74 8.98 17.38 8.98 15.72C8.98 14.05 10.34 12.7 12 12.7C13.66 12.7 15.02 14.06 15.02 15.72C15.02 17.39 13.67 18.74 12 18.74ZM7.35 9.44C7.27 9.44 7.2 9.44 7.12 9.44V8.28C7.12 5.35 7.95 3.4 12 3.4C16.05 3.4 16.88 5.35 16.88 8.28V9.45C16.8 9.45 16.73 9.45 16.65 9.45H7.35V9.44Z" fill="currentColor"></path>
                  </svg>
                </div>
              </div>
            </div>
-->
            <div class="mb-4">
                <div class="floating-group">
                    <input
                    type="password"
                    name="password"
                    id="id_password"
                    placeholder=" "
                    autocomplete="current-password"
                    >
                    <label for="id_password">Contraseña <span class="text-danger">*</span></label>

                    <button class="field-icon field-icon-btn" type="button" id="togglePass" aria-label="Mostrar/ocultar contraseña">
                        <svg id="passIcon" width="3cm" height="4cm" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">

                        <!-- Arco grande y centrado -->
                        <path d="M9 10V7.8a3.5 3.5 0 0 1 7 0V10" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"></path>

                        <!-- Cuerpo del candado -->
                        <rect x="5" y="10" width="15" height="10" rx="3" fill="currentColor"></rect>

                        <!-- Círculo blanco -->
                        <circle cx="13" cy="15" r="2.1" fill="#fff"></circle>

                        <!-- Punto central -->
                        <circle cx="13" cy="15" r="0.9" fill="currentColor"></circle>

                        </svg>
                        </button>


                </div>
            </div>

            <div class="d-flex justify-content-end">
              <button class="btn btn-gad" type="submit">
                Ingresar
                <!-- icono a la derecha -->
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <path d="M10 17l5-5-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M4 12h11" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
              </button>
            </div>
          </form>

        </div>

        <p class="text-center text-white small mt-4 mb-0">
          © {% now "Y" %} GAD Municipal de Salcedo
        </p>

      </div>
    </div>
  </div>

  <!-- JS -->
  <script src="{% static 'assets/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/js/iziToast.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script>
    // ===========
    // Validación simple: solo borde rojo (SIN TOAST por campos vacíos)
    // ===========
    (function(){
      const form = document.getElementById("loginForm");
      const u = document.getElementById("id_username");
      const p = document.getElementById("id_password");
      const iconU = document.getElementById("iconUser");
      const iconP = document.getElementById("togglePass");

      if(!form || !u || !p) return;

      function mark(el, icon, invalid){
        if(invalid){
          el.classList.add("is-invalid-soft");
          icon && icon.classList.add("icon-invalid");
        }else{
          el.classList.remove("is-invalid-soft");
          icon && icon.classList.remove("icon-invalid");
        }
      }

      function validate(){
        const uVal = (u.value || "").trim();
        const pVal = (p.value || "").trim();
        mark(u, iconU, !uVal);
        mark(p, iconP, !pVal);
        return !!(uVal && pVal);
      }

      u.addEventListener("input", validate);
      p.addEventListener("input", validate);

      form.addEventListener("submit", function(e){
        if(!validate()){
          e.preventDefault();
        }
      });
    })();
    // ===========
// Toggle contraseña (candado -> mostrar/ocultar)
// ===========
(function(){
  const btn = document.getElementById("togglePass");
  const input = document.getElementById("id_password");
  if(!btn || !input) return;

  btn.addEventListener("click", function(){
    input.type = (input.type === "password") ? "text" : "password";
  });
})();

    // ===========
    // Toast SOLO desde Django messages (ej: usuario/clave incorrectos)
    // (Esto evita toasts infinitos)
    // ===========
    document.addEventListener("DOMContentLoaded", function(){
      {% if messages %}
        {% for message in messages %}
          {% if "error" in message.tags or "danger" in message.tags %}
            iziToast.show({
              title: "Acceso denegado",
              message: "{{ message|escapejs }}",
              position: "topRight",
              timeout: 2200,
              closeOnClick: true,
              backgroundColor: "#ffffff",
              titleColor: "#111827",
              messageColor: "#374151",
              progressBarColor: "#D32F2F",
              iconColor: "#D32F2F"
            });
          {% elif "success" in message.tags %}
            iziToast.show({
              title: "Éxito",
              message: "{{ message|escapejs }}",
              position: "topRight",
              timeout: 2200,
              closeOnClick: true,
              backgroundColor: "#ffffff",
              titleColor: "#111827",
              messageColor: "#374151",
              progressBarColor: "#0B3A6E",
              iconColor: "#0B3A6E"
            });
          {% elif "warning" in message.tags %}
            iziToast.show({
              title: "Atención",
              message: "{{ message|escapejs }}",
              position: "topRight",
              timeout: 2200,
              closeOnClick: true,
              backgroundColor: "#ffffff",
              titleColor: "#111827",
              messageColor: "#374151",
              progressBarColor: "#F28C28",
              iconColor: "#F28C28"
            });
          {% endif %}
        {% endfor %}
      {% endif %}
    });
  </script>

</body>
</html>
