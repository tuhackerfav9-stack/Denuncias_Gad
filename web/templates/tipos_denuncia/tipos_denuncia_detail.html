{% extends 'base.html' %}
{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-12 col-lg-10 mx-auto">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1 class="h3 mb-0">
                    <i class="bi bi-folder-fill me-2"></i>Detalle del Tipo de Denuncia
                </h1>
                <div class="btn-group" role="group">
                    <a href="{% url 'web:tipos_denuncia_update' tipo_denuncia.pk %}" class="btn btn-warning">
                        <i class="bi bi-pencil me-2"></i>Editar
                    </a>
                    <a href="{% url 'web:tipos_denuncia_delete' tipo_denuncia.pk %}" class="btn btn-danger" onclick="return confirm('¿Está seguro de eliminar este tipo de denuncia?')">
                        <i class="bi bi-trash me-2"></i>Eliminar
                    </a>
                    <a href="{% url 'web:tipos_denuncia_list' %}" class="btn btn-secondary">
                        <i class="bi bi-arrow-left me-2"></i>Volver
                    </a>
                </div>
            </div>

            <!-- Información General -->
            <div class="card shadow-sm mb-3">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0"><i class="bi bi-info-circle me-2"></i>Información General</h5>
                </div>
                <div class="card-body">
                    <dl class="row mb-0">
                        <dt class="col-sm-3">Nombre:</dt>
                        <dd class="col-sm-9"><strong>{{ tipo_denuncia.nombre }}</strong></dd>
                        
                        <dt class="col-sm-3">Descripción:</dt>
                        <dd class="col-sm-9">{{ tipo_denuncia.descripcion|default:"Sin descripción" }}</dd>
                        
                        <dt class="col-sm-3">Estado:</dt>
                        <dd class="col-sm-9">
                            {% if tipo_denuncia.activo %}
                                <span class="badge bg-success fs-6">Activo</span>
                            {% else %}
                                <span class="badge bg-secondary fs-6">Inactivo</span>
                            {% endif %}
                        </dd>
                        
                        <dt class="col-sm-3">Fecha de Creación:</dt>
                        <dd class="col-sm-9">{{ tipo_denuncia.created_at|date:"d/m/Y H:i:s" }}</dd>
                        
                        <dt class="col-sm-3">Última Actualización:</dt>
                        <dd class="col-sm-9">{{ tipo_denuncia.updated_at|date:"d/m/Y H:i:s" }}</dd>
                    </dl>
                </div>
            </div>

            <div class="row">
                <!-- Departamento Asignado -->
                <div class="col-md-6 mb-3">
                    <div class="card shadow-sm h-100">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0"><i class="bi bi-building me-2"></i>Departamento Asignado</h5>
                        </div>
                        <div class="card-body">
                            {% if departamento_asignado %}
                                <dl class="row mb-0">
                                    <dt class="col-sm-5">Departamento:</dt>
                                    <dd class="col-sm-7">{{ departamento_asignado.nombre }}</dd>
                                    
                                    <dt class="col-sm-5">Estado:</dt>
                                    <dd class="col-sm-7">
                                        {% if departamento_asignado.activo %}
                                            <span class="badge bg-success">Activo</span>
                                        {% else %}
                                            <span class="badge bg-secondary">Inactivo</span>
                                        {% endif %}
                                    </dd>
                                </dl>
                                <p class="text-muted mb-0 mt-3">
                                    <i class="bi bi-info-circle me-1"></i>
                                    Este tipo de denuncia será atendido por el departamento <strong>{{ departamento_asignado.nombre }}</strong>.
                                </p>
                            {% else %}
                                <div class="alert alert-warning mb-0" role="alert">
                                    <i class="bi bi-exclamation-triangle me-2"></i>
                                    Este tipo de denuncia no tiene un departamento asignado. 
                                    <a href="{% url 'web:tipo_denuncia_departamento_create' %}" class="alert-link">Asignar departamento</a>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Estadísticas -->
                <div class="col-md-6 mb-3">
                    <div class="card shadow-sm h-100">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0"><i class="bi bi-bar-chart-fill me-2"></i>Estadísticas</h5>
                        </div>
                        <div class="card-body">
                            <dl class="row mb-0">
                                <dt class="col-sm-6">Total de Denuncias:</dt>
                                <dd class="col-sm-6">
                                    <span class="badge bg-info fs-6">{{ total_denuncias }}</span>
                                </dd>
                                
                                <dt class="col-sm-6">Disponible para ciudadanos:</dt>
                                <dd class="col-sm-6">
                                    {% if tipo_denuncia.activo %}
                                        <i class="bi bi-check-circle-fill text-success"></i> Sí
                                    {% else %}
                                        <i class="bi bi-x-circle-fill text-danger"></i> No
                                    {% endif %}
                                </dd>
                            </dl>
                            <p class="text-muted mb-0 mt-3">
                                <i class="bi bi-info-circle me-1"></i>
                                Se han registrado <strong>{{ total_denuncias }}</strong> 
                                {{ total_denuncias|pluralize:"denuncia,denuncias" }} de este tipo.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            {% if not tipo_denuncia.activo %}
            <div class="alert alert-warning mt-3" role="alert">
                <i class="bi bi-exclamation-triangle me-2"></i>
                <strong>Advertencia:</strong> Este tipo de denuncia está inactivo y no estará disponible para que los ciudadanos lo seleccionen al hacer una denuncia.
            </div>
            {% endif %}

            {% if total_denuncias > 0 %}
            <div class="alert alert-info mt-3" role="alert">
                <i class="bi bi-info-circle me-2"></i>
                <strong>Nota:</strong> Este tipo de denuncia tiene {{ total_denuncias }} 
                {{ total_denuncias|pluralize:"denuncia asociada,denuncias asociadas" }}. 
                Ten esto en cuenta antes de realizar cambios.
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
